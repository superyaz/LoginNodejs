require('./../config/config');
const express = require('express');
const bodyParser = require('body-parser');
const mongoose = require('mongoose');

const app = express();

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/*
 * Se configura el body parse para manejar los datos
 */
// parse application/x-www-form-urlencoded
app.use(bodyParser.urlencoded({ extended: false }))

// parse application/json
app.use(bodyParser.json())
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/** 
 * Requiero mi archivo de rutas
 */


app.use(require("../routes/indexRoutes"));

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/**
 * Se crea la conexiÃ³n a la base de datos
 */
mongoose.connect('mongodb+srv://superyaz:yaz.456@cluster0-yfzao.mongodb.net/test?retryWrites=true&w=majority',
    {
        useNewUrlParser: true,
        useUnifiedTopology: true
    }).then(() => console.log('Se conecto correctamente a la BD'))
    .catch((err) => console.log(err))

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/**
 * Se inicia el servidor Node
 */
app.listen(process.env.PORT, (err) => {
    if (err) {
        console.log(err);
    }
    console.log('Se inicio el servidor correctamente....');
})

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


